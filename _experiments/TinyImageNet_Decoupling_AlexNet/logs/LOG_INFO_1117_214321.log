[2020-11-17 21:43:21] INFO: Algorithm options {'data_train_opt': {'batch_size': 192, 'unsupervised': True, 'random_sized_crop': True, 'dataset_name': 'tiny-imagenet', 'split': 'train'}, 'data_test_opt': {'batch_size': 192, 'unsupervised': True, 'random_sized_crop': False, 'dataset_name': 'tiny-imagenet', 'split': 'val'}, 'max_num_epochs': 245, 'networks': {'feature': {'def_file': 'architectures/AlexNetFeature.py', 'pretrained': None, 'opt': {}, 'optim_params': {'optim_type': 'sgd', 'lr': 0.1, 'momentum': 0.9, 'weight_decay': 0.0005, 'nesterov': True, 'LUT_lr': [(90, 0.01), (130, 0.001), (190, 0.0001), (210, 1e-05), (230, 0.0001), (245, 1e-05)]}}, 'classifier': {'def_file': 'architectures/AlexNetClassifier.py', 'pretrained': None, 'opt': {'num_classes': 4}, 'optim_params': {'optim_type': 'sgd', 'lr': 0.1, 'momentum': 0.9, 'weight_decay': 0.0005, 'nesterov': True, 'LUT_lr': [(90, 0.01), (130, 0.001), (190, 0.0001), (210, 1e-05), (230, 0.0001), (245, 1e-05)]}}, 'norm': {'def_file': 'architectures/LinearTransformationNorm.py', 'pretrained': None, 'opt': {'low_dim': 128, 'num_feat': 2048}, 'optim_params': {'optim_type': 'sgd', 'lr': 0.1, 'momentum': 0.9, 'weight_decay': 0.0005, 'nesterov': True, 'LUT_lr': [(90, 0.01), (130, 0.001), (190, 0.0001), (210, 1e-05), (230, 0.0001), (245, 1e-05)]}}}, 'criterions': {'loss_cls': {'ctype': 'CrossEntropyLoss', 'opt': {'reduce': False}}, 'loss_mse': {'ctype': 'MSELoss', 'opt': None}, 'nce_average': {'ctype': 'NCEAverage', 'opt': {'def_file': 'architectures/NCEAverage.py', 'net_opt': {'low_dim': 128, 'ndata': 100000, 'nce_k': 4096, 'nce_t': 0.07, 'nce_m': 0.5}}}, 'nce_criterion': {'ctype': 'NCECriterion', 'opt': {'def_file': 'architectures/NCECriterion.py', 'net_opt': {'ndata': 100000}}}}, 'lambda_loss': {'cls': 1.0, 'mse': 1.0, 'nce': 1.0}, 'gama': 2, 'algorithm_type': 'DecouplingModel', 'exp_dir': '../_experiments/TinyImageNet_Decoupling_AlexNet', 'disp_step': 1}
[2020-11-17 21:43:21] INFO: Set network feature
[2020-11-17 21:43:21] INFO: ==> Initiliaze network feature from file architectures/AlexNetFeature.py with opts: {}
[2020-11-17 21:43:21] INFO: Set network classifier
[2020-11-17 21:43:21] INFO: ==> Initiliaze network classifier from file architectures/AlexNetClassifier.py with opts: {'num_classes': 4}
[2020-11-17 21:43:21] INFO: Set network norm
[2020-11-17 21:43:21] INFO: ==> Initiliaze network norm from file architectures/LinearTransformationNorm.py with opts: {'low_dim': 128, 'num_feat': 2048}
[2020-11-17 21:43:21] INFO: Initialize criterion[loss_cls]: CrossEntropyLoss with options: {'reduce': False}
[2020-11-17 21:43:21] INFO: Initialize criterion[loss_mse]: MSELoss with options: None
[2020-11-17 21:43:21] INFO: Initialize criterion[nce_average]: NCEAverage with options: {'def_file': 'architectures/NCEAverage.py', 'net_opt': {'low_dim': 128, 'ndata': 100000, 'nce_k': 4096, 'nce_t': 0.07, 'nce_m': 0.5}}
[2020-11-17 21:43:23] INFO: Initialize criterion[nce_criterion]: NCECriterion with options: {'def_file': 'architectures/NCECriterion.py', 'net_opt': {'ndata': 100000}}
[2020-11-17 21:43:23] INFO: ==> Initiliaze network NCECriterion from file architectures/NCECriterion.py with opts: {'ndata': 100000}
[2020-11-17 21:43:29] INFO: Initialize optimizer: sgd with params: {'optim_type': 'sgd', 'lr': 0.1, 'momentum': 0.9, 'weight_decay': 0.0005, 'nesterov': True, 'LUT_lr': [(90, 0.01), (130, 0.001), (190, 0.0001), (210, 1e-05), (230, 0.0001), (245, 1e-05)]} for network: feature
[2020-11-17 21:43:29] INFO: Initialize optimizer: sgd with params: {'optim_type': 'sgd', 'lr': 0.1, 'momentum': 0.9, 'weight_decay': 0.0005, 'nesterov': True, 'LUT_lr': [(90, 0.01), (130, 0.001), (190, 0.0001), (210, 1e-05), (230, 0.0001), (245, 1e-05)]} for network: classifier
[2020-11-17 21:43:29] INFO: Initialize optimizer: sgd with params: {'optim_type': 'sgd', 'lr': 0.1, 'momentum': 0.9, 'weight_decay': 0.0005, 'nesterov': True, 'LUT_lr': [(90, 0.01), (130, 0.001), (190, 0.0001), (210, 1e-05), (230, 0.0001), (245, 1e-05)]} for network: norm
[2020-11-17 21:43:29] INFO: 

[2020-11-17 21:43:29] INFO: Training epoch [  1 / 245]
[2020-11-17 21:43:29] INFO: ==> Set to feature optimizer lr = 0.0100000000
[2020-11-17 21:43:29] INFO: ==> Set to classifier optimizer lr = 0.0100000000
[2020-11-17 21:43:29] INFO: ==> Set to norm optimizer lr = 0.0100000000
[2020-11-17 21:43:29] INFO: Training: TinyImageNet_Decoupling_AlexNet
[2020-11-17 21:43:29] INFO: ==> Dataset: tiny-imagenet_train [100000 images]
[2020-11-17 21:43:29] INFO: ==> Iteration steps in one epoch: 521 [batch size 192]
[2020-11-17 21:43:37] INFO: ==> Iteration [  1][   1 /  521]: {'prec_cls': 24.7396, 'loss': 11.7207, 'loss_cls': 1.404, 'loss_mse': 0.0648, 'loss_nce': 10.2519, 'load_time': 1.263, 'process_time': 98.737}
[2020-11-17 21:43:43] INFO: ==> Iteration [  1][   2 /  521]: {'prec_cls': 24.9349, 'loss': 11.8128, 'loss_cls': 1.4008, 'loss_mse': 0.0622, 'loss_nce': 10.3498, 'load_time': 11.3532, 'process_time': 88.6468}
[2020-11-17 21:43:47] INFO: ==> Iteration [  1][   3 /  521]: {'prec_cls': 25.9983, 'loss': 11.8326, 'loss_cls': 1.3972, 'loss_mse': 0.0593, 'loss_nce': 10.376, 'load_time': 14.7993, 'process_time': 85.2007}
[2020-11-17 21:43:52] INFO: ==> Iteration [  1][   4 /  521]: {'prec_cls': 27.7018, 'loss': 11.9151, 'loss_cls': 1.3898, 'loss_mse': 0.056, 'loss_nce': 10.4693, 'load_time': 16.4944, 'process_time': 83.5056}
[2020-11-17 21:43:57] INFO: ==> Iteration [  1][   5 /  521]: {'prec_cls': 28.6719, 'loss': 12.0209, 'loss_cls': 1.3863, 'loss_mse': 0.053, 'loss_nce': 10.5816, 'load_time': 17.5088, 'process_time': 82.4912}
[2020-11-17 21:44:01] INFO: ==> Iteration [  1][   6 /  521]: {'prec_cls': 29.7526, 'loss': 12.1436, 'loss_cls': 1.3818, 'loss_mse': 0.0504, 'loss_nce': 10.7113, 'load_time': 18.1677, 'process_time': 81.8323}
[2020-11-17 21:44:06] INFO: ==> Iteration [  1][   7 /  521]: {'prec_cls': 29.8735, 'loss': 12.2862, 'loss_cls': 1.3783, 'loss_mse': 0.0475, 'loss_nce': 10.8605, 'load_time': 18.6605, 'process_time': 81.3395}
[2020-11-17 21:44:11] INFO: ==> Iteration [  1][   8 /  521]: {'prec_cls': 30.4525, 'loss': 12.4244, 'loss_cls': 1.3753, 'loss_mse': 0.045, 'loss_nce': 11.0041, 'load_time': 19.0099, 'process_time': 80.9901}
[2020-11-17 21:44:15] INFO: ==> Iteration [  1][   9 /  521]: {'prec_cls': 30.7147, 'loss': 12.5688, 'loss_cls': 1.3748, 'loss_mse': 0.0427, 'loss_nce': 11.1513, 'load_time': 19.2877, 'process_time': 80.7123}
[2020-11-17 21:44:20] INFO: ==> Iteration [  1][  10 /  521]: {'prec_cls': 31.1589, 'loss': 12.7476, 'loss_cls': 1.3722, 'loss_mse': 0.0406, 'loss_nce': 11.3349, 'load_time': 19.5256, 'process_time': 80.4744}
[2020-11-17 21:44:25] INFO: ==> Iteration [  1][  11 /  521]: {'prec_cls': 31.4631, 'loss': 12.9022, 'loss_cls': 1.3715, 'loss_mse': 0.0385, 'loss_nce': 11.4922, 'load_time': 19.6896, 'process_time': 80.3104}
[2020-11-17 21:44:29] INFO: ==> Iteration [  1][  12 /  521]: {'prec_cls': 32.1398, 'loss': 13.0796, 'loss_cls': 1.3665, 'loss_mse': 0.0366, 'loss_nce': 11.6766, 'load_time': 19.8537, 'process_time': 80.1463}
[2020-11-17 21:44:34] INFO: ==> Iteration [  1][  13 /  521]: {'prec_cls': 32.2316, 'loss': 13.2785, 'loss_cls': 1.3665, 'loss_mse': 0.0347, 'loss_nce': 11.8773, 'load_time': 20.0, 'process_time': 80.0}
[2020-11-17 21:44:39] INFO: ==> Iteration [  1][  14 /  521]: {'prec_cls': 32.5521, 'loss': 13.4783, 'loss_cls': 1.3643, 'loss_mse': 0.033, 'loss_nce': 12.081, 'load_time': 20.1235, 'process_time': 79.8765}
[2020-11-17 21:44:45] INFO: ==> Iteration [  1][  15 /  521]: {'prec_cls': 32.8819, 'loss': 13.6574, 'loss_cls': 1.3615, 'loss_mse': 0.0314, 'loss_nce': 12.2645, 'load_time': 20.2311, 'process_time': 79.7689}
[2020-11-17 21:44:49] INFO: ==> Iteration [  1][  16 /  521]: {'prec_cls': 33.2275, 'loss': 13.8353, 'loss_cls': 1.3595, 'loss_mse': 0.0298, 'loss_nce': 12.446, 'load_time': 20.3211, 'process_time': 79.6789}
[2020-11-17 21:44:53] INFO: ==> Iteration [  1][  17 /  521]: {'prec_cls': 33.3869, 'loss': 14.0592, 'loss_cls': 1.3588, 'loss_mse': 0.0284, 'loss_nce': 12.672, 'load_time': 20.4096, 'process_time': 79.5904}
[2020-11-17 21:44:58] INFO: ==> Iteration [  1][  18 /  521]: {'prec_cls': 33.5286, 'loss': 14.2592, 'loss_cls': 1.3569, 'loss_mse': 0.0271, 'loss_nce': 12.8752, 'load_time': 20.4866, 'process_time': 79.5134}
[2020-11-17 21:45:03] INFO: ==> Iteration [  1][  19 /  521]: {'prec_cls': 33.5458, 'loss': 14.476, 'loss_cls': 1.3566, 'loss_mse': 0.0259, 'loss_nce': 13.0935, 'load_time': 20.5511, 'process_time': 79.4489}
[2020-11-17 21:45:07] INFO: ==> Iteration [  1][  20 /  521]: {'prec_cls': 33.5482, 'loss': 14.7036, 'loss_cls': 1.3559, 'loss_mse': 0.0249, 'loss_nce': 13.3228, 'load_time': 20.6153, 'process_time': 79.3847}
[2020-11-17 21:45:12] INFO: ==> Iteration [  1][  21 /  521]: {'prec_cls': 33.724, 'loss': 14.9402, 'loss_cls': 1.3555, 'loss_mse': 0.0238, 'loss_nce': 13.5609, 'load_time': 20.6489, 'process_time': 79.3511}
[2020-11-17 21:45:16] INFO: ==> Iteration [  1][  22 /  521]: {'prec_cls': 33.8542, 'loss': 15.1768, 'loss_cls': 1.3542, 'loss_mse': 0.0229, 'loss_nce': 13.7998, 'load_time': 20.693, 'process_time': 79.307}
[2020-11-17 21:45:20] INFO: ==> Iteration [  1][  23 /  521]: {'prec_cls': 33.8542, 'loss': 15.4323, 'loss_cls': 1.3537, 'loss_mse': 0.022, 'loss_nce': 14.0566, 'load_time': 20.7389, 'process_time': 79.2611}
[2020-11-17 21:45:25] INFO: ==> Iteration [  1][  24 /  521]: {'prec_cls': 34.0712, 'loss': 15.6557, 'loss_cls': 1.3521, 'loss_mse': 0.0212, 'loss_nce': 14.2825, 'load_time': 20.7793, 'process_time': 79.2207}
[2020-11-17 21:45:30] INFO: ==> Iteration [  1][  25 /  521]: {'prec_cls': 34.2812, 'loss': 15.8819, 'loss_cls': 1.3516, 'loss_mse': 0.0204, 'loss_nce': 14.5098, 'load_time': 20.8264, 'process_time': 79.1736}
[2020-11-17 21:45:35] INFO: ==> Iteration [  1][  26 /  521]: {'prec_cls': 34.38, 'loss': 16.0767, 'loss_cls': 1.3499, 'loss_mse': 0.0197, 'loss_nce': 14.7071, 'load_time': 20.8618, 'process_time': 79.1382}
[2020-11-17 21:45:39] INFO: ==> Iteration [  1][  27 /  521]: {'prec_cls': 34.4763, 'loss': 16.2729, 'loss_cls': 1.3491, 'loss_mse': 0.0191, 'loss_nce': 14.9047, 'load_time': 20.8977, 'process_time': 79.1023}
[2020-11-17 21:45:43] INFO: ==> Iteration [  1][  28 /  521]: {'prec_cls': 34.4773, 'loss': 16.4402, 'loss_cls': 1.3495, 'loss_mse': 0.0184, 'loss_nce': 15.0722, 'load_time': 20.9246, 'process_time': 79.0754}
[2020-11-17 21:45:48] INFO: ==> Iteration [  1][  29 /  521]: {'prec_cls': 34.4513, 'loss': 16.5955, 'loss_cls': 1.3488, 'loss_mse': 0.0179, 'loss_nce': 15.2289, 'load_time': 20.9512, 'process_time': 79.0488}
[2020-11-17 21:45:53] INFO: ==> Iteration [  1][  30 /  521]: {'prec_cls': 34.3576, 'loss': 16.7514, 'loss_cls': 1.349, 'loss_mse': 0.0173, 'loss_nce': 15.385, 'load_time': 20.9724, 'process_time': 79.0276}
[2020-11-17 21:45:58] INFO: ==> Iteration [  1][  31 /  521]: {'prec_cls': 34.3624, 'loss': 16.9085, 'loss_cls': 1.3492, 'loss_mse': 0.0168, 'loss_nce': 15.5425, 'load_time': 20.9777, 'process_time': 79.0223}
[2020-11-17 21:46:02] INFO: ==> Iteration [  1][  32 /  521]: {'prec_cls': 34.3994, 'loss': 17.0482, 'loss_cls': 1.3485, 'loss_mse': 0.0163, 'loss_nce': 15.6834, 'load_time': 20.9914, 'process_time': 79.0086}
[2020-11-17 21:46:07] INFO: ==> Iteration [  1][  33 /  521]: {'prec_cls': 34.4302, 'loss': 17.1917, 'loss_cls': 1.3485, 'loss_mse': 0.0159, 'loss_nce': 15.8273, 'load_time': 21.0101, 'process_time': 78.9899}
[2020-11-17 21:46:11] INFO: ==> Iteration [  1][  34 /  521]: {'prec_cls': 34.5741, 'loss': 17.3277, 'loss_cls': 1.3479, 'loss_mse': 0.0154, 'loss_nce': 15.9643, 'load_time': 21.0318, 'process_time': 78.9682}
[2020-11-17 21:46:16] INFO: ==> Iteration [  1][  35 /  521]: {'prec_cls': 34.628, 'loss': 17.4602, 'loss_cls': 1.3487, 'loss_mse': 0.015, 'loss_nce': 16.0965, 'load_time': 21.0476, 'process_time': 78.9524}
[2020-11-17 21:46:21] INFO: ==> Iteration [  1][  36 /  521]: {'prec_cls': 34.6246, 'loss': 17.5853, 'loss_cls': 1.3488, 'loss_mse': 0.0146, 'loss_nce': 16.2218, 'load_time': 21.06, 'process_time': 78.94}
[2020-11-17 21:46:26] INFO: ==> Iteration [  1][  37 /  521]: {'prec_cls': 34.6178, 'loss': 17.7196, 'loss_cls': 1.349, 'loss_mse': 0.0143, 'loss_nce': 16.3563, 'load_time': 21.0735, 'process_time': 78.9265}
[2020-11-17 21:46:30] INFO: ==> Iteration [  1][  38 /  521]: {'prec_cls': 34.5737, 'loss': 17.8435, 'loss_cls': 1.3492, 'loss_mse': 0.0139, 'loss_nce': 16.4804, 'load_time': 21.0858, 'process_time': 78.9142}
[2020-11-17 21:46:34] INFO: ==> Iteration [  1][  39 /  521]: {'prec_cls': 34.5453, 'loss': 17.9634, 'loss_cls': 1.3486, 'loss_mse': 0.0136, 'loss_nce': 16.6012, 'load_time': 21.0984, 'process_time': 78.9016}
[2020-11-17 21:46:39] INFO: ==> Iteration [  1][  40 /  521]: {'prec_cls': 34.6094, 'loss': 18.0869, 'loss_cls': 1.3483, 'loss_mse': 0.0133, 'loss_nce': 16.7254, 'load_time': 21.1092, 'process_time': 78.8908}
[2020-11-17 21:46:44] INFO: ==> Iteration [  1][  41 /  521]: {'prec_cls': 34.5433, 'loss': 18.2079, 'loss_cls': 1.3485, 'loss_mse': 0.013, 'loss_nce': 16.8465, 'load_time': 21.1102, 'process_time': 78.8898}
[2020-11-17 21:46:48] INFO: ==> Iteration [  1][  42 /  521]: {'prec_cls': 34.6571, 'loss': 18.3279, 'loss_cls': 1.3478, 'loss_mse': 0.0127, 'loss_nce': 16.9673, 'load_time': 21.1177, 'process_time': 78.8823}
[2020-11-17 21:46:53] INFO: ==> Iteration [  1][  43 /  521]: {'prec_cls': 34.6203, 'loss': 18.4402, 'loss_cls': 1.348, 'loss_mse': 0.0125, 'loss_nce': 17.0797, 'load_time': 21.1288, 'process_time': 78.8712}
[2020-11-17 21:46:58] INFO: ==> Iteration [  1][  44 /  521]: {'prec_cls': 34.7242, 'loss': 18.5373, 'loss_cls': 1.3475, 'loss_mse': 0.0122, 'loss_nce': 17.1776, 'load_time': 21.14, 'process_time': 78.86}
[2020-11-17 21:47:03] INFO: ==> Iteration [  1][  45 /  521]: {'prec_cls': 34.7396, 'loss': 18.6314, 'loss_cls': 1.3474, 'loss_mse': 0.012, 'loss_nce': 17.272, 'load_time': 21.1524, 'process_time': 78.8476}
[2020-11-17 21:47:07] INFO: ==> Iteration [  1][  46 /  521]: {'prec_cls': 34.7769, 'loss': 18.7197, 'loss_cls': 1.3471, 'loss_mse': 0.0117, 'loss_nce': 17.3608, 'load_time': 21.165, 'process_time': 78.835}
[2020-11-17 21:47:12] INFO: ==> Iteration [  1][  47 /  521]: {'prec_cls': 34.7407, 'loss': 18.801, 'loss_cls': 1.3473, 'loss_mse': 0.0115, 'loss_nce': 17.4422, 'load_time': 21.1767, 'process_time': 78.8233}
[2020-11-17 21:47:16] INFO: ==> Iteration [  1][  48 /  521]: {'prec_cls': 34.6924, 'loss': 18.8684, 'loss_cls': 1.3479, 'loss_mse': 0.0113, 'loss_nce': 17.5092, 'load_time': 21.1906, 'process_time': 78.8094}
[2020-11-17 21:47:21] INFO: ==> Iteration [  1][  49 /  521]: {'prec_cls': 34.7337, 'loss': 18.9503, 'loss_cls': 1.3476, 'loss_mse': 0.0111, 'loss_nce': 17.5916, 'load_time': 21.2038, 'process_time': 78.7962}
